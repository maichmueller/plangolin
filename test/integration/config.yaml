seed_everything: true

experiment: "pytest"

data:
  batch_size: 26
  parallel: False
  train_dataloader_kwargs:
      num_workers: 0
      pin_memory: false
      persistent_workers: false

encoder:
  class_path: HeteroGraphEncoder

collate:
  func: plangolin.rl.thundeRL.to_transitions_batch

reward:
  class_path: FlatReward
  init_args:
    gamma: 0.9

optimizer_setup:
  optimizer:
    class_path: torch.optim.Adam
    init_args:
      lr: 0.002
  lr_actor: 0.0002

data_layout:
  input_data:
    domain_name: blocks
    instances: [ small, medium ]
    validation_instances: [ small ]
  root_dir: null

trainer:
  accelerator: "cpu"
  devices: 1
  max_epochs: 1
  logger:
    class_path: lightning.pytorch.loggers.WandbLogger
    init_args:
      project: plangolin
      group: rl-test
      offline: True

loss:
  class_path: ActorCriticLoss

estimator_config:
  estimator_type: TD0
  gamma: 0.9

model:
  gnn:
    class_path: RelationalGNN
    init_args:
      num_layer: 2
      embedding_size: 2
      aggr: logsumexp
